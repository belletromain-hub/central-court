<analysis>**original_problem_statement:**
The user wants to build a professional tennis application. The project has evolved through several phases:
1.  **Initial Setup & Refactoring:** Modular FastAPI backend, MongoDB migration, Resend integration.
2.  **Admin Dashboard:** A full-stack admin dashboard for user and metrics management.
3.  **Fluid UX & Onboarding:** A complete multi-step user onboarding flow.
4.  **UI/UX Enhancements:** Apple-style wheel picker components, redesigned Documents tab.
5.  **High-Performance OCR System:** An ultra-performant OCR system to handle images and PDFs, using  for structured data extraction, with a robust frontend for user verification and inline editing.
6.  **Data Persistence & Export:** Store all processed documents in MongoDB and provide a PDF export feature.
7.  **Profile Management:** Redesign the profile page to show key user info and provide a simplified screen for updates.

**User's preferred language**: French. The next agent MUST respond in French.

**what currently exists?**
A full-stack application with a React Native (Expo) frontend, a Python (FastAPI) backend, and a MongoDB database. The core features are implemented, including:
*   A complete, multi-step user onboarding flow.
*   An advanced OCR system that processes both images and PDFs, extracts structured data, and allows users to verify and edit the results inline.
*   Full backend integration with MongoDB to persist, retrieve, update, and delete all user documents.
*   A backend endpoint to export user documents to a PDF file.
*   An updated profile page that dynamically loads and displays the user's name and ranking from the backend.
*   Apple-style wheel pickers integrated into the onboarding flow for date selection.

**Last working item**:
*   **Last item agent was working:** The agent was implementing the user's request for a redesigned profile page and a simplified profile update screen. The agent successfully modified the profile view () to display the user's name and ranking from the backend. The backend user model () was also updated to support a new  field. The work stopped before creating the simplified editing screen.
*   **Status:** IN PROGRESS
*   **Agent Testing Done:** N
*   **Which testing method agent to use?** Frontend testing agent. The test should cover the full user flow: viewing the profile, navigating to the edit screen, modifying the ranking, email, and fiscal residence, saving the changes, and verifying that the profile page updates correctly.
*   **User Testing Done:** N

**All Pending/In progress Issue list**:
*   **Issue 1: Critical and recurring frontend crash (P0)**
    *   **Description:** The application intermittently crashes with the error . This error appears to be caused by an incompatibility between the versions of ,  packages, and React 19.
    *   **Attempted fixes:** The agent tried numerous solutions: creating , clearing the Metro cache, completely reinstalling , and changing the provider order in the root layout. A full dependency reinstall (yarn install v1.22.22
[1/4] Resolving packages...
[2/4] Fetching packages...
[3/4] Linking dependencies...
info Visit https://yarnpkg.com/en/docs/cli/install for documentation about this command.) provided a temporary fix, but the error returned, indicating a deep-rooted dependency conflict.
    *   **Next debug checklist:**
        1.  Do not assume the issue is gone. It is a critical blocker.
        2.  Use the  with the full history of attempted fixes.
        3.  Consult the Expo and React Navigation documentation for known compatibility issues with Expo SDK 54/55 and React 19.
        4.  Systematically check  for version mismatches across all  packages and align them with a known stable configuration for .
    *   **Why fix this issue and what will be achieved with the fix?** This is a critical stability issue that makes the application unreliable and blocks all further frontend development and testing. Fixing it will stabilize the application's navigation and rendering.
    *   **Status:** BLOCKED
    *   **Is recurring issue?** Y
    *   **Should Test frontend/backend/both after fix?** Frontend
    *   **Blocked on other issue:** No, this is the primary blocker.

**In progress Task List**:
*   **Task 1: Complete Simplified Profile Update Feature (P0)**
    *   **Where to resume:**
        1.  Create the navigation from the profile page () to the edit page.
        2.  Create or modify the profile edit screen () to be a simplified form containing only three editable fields:  (ranking), , and  (desired fiscal residence).
        3.  Implement the  logic to call the  endpoint.
    *   **What will be achieved with this?** Fulfills the user's request for a streamlined profile management experience.
    *   **Status:** IN PROGRESS
    *   **Should Test frontend/backend/both after fix?** Both
    *   **Blocked on something:** Blocked by **Issue 1**, as navigation may be unreliable.

**Upcoming and Future Tasks**
*   **Upcoming Tasks:**
    *   **P1: Implement Document Filtering by Date:** Add a date range picker to  and connect it to the  endpoint, passing  and  parameters to filter the document list.
    *   **P1: Integrate Apple Wheel Picker for Document Date:** Integrate the  component into the document edit modal in  to replace the standard text input for dates.
    *   **P2: Implement PDF Export on Frontend:** Add a button to the  UI that calls the  endpoint and handles the download/display of the generated PDF file.
*   **Future Tasks:**
    *   Implement push notifications.

**Completed work in this session**
- **High-Performance OCR System:** Implemented a full-stack OCR pipeline for images and PDFs with a verification screen and inline editing capabilities.
- **MongoDB Data Persistence:** Backend and frontend were fully integrated to save, load, edit, and delete documents from a MongoDB collection, replacing all static data.
- **Backend PDF Export:** Created an endpoint () using  to generate a PDF summary of documents.
- **Apple Wheel Picker Integration:** Successfully integrated the  into the user onboarding flow, after resolving a critical application crash.
- **Profile Page Redesign:** Updated the backend model and frontend view () to dynamically display the user's name and ranking.

**Earlier issues found/mentioned but not fixed**
*   **Issue 1: Backend API Route Conflict:**
    *   **Description:** In , the static route  is defined after the dynamic route . This causes requests to  to be incorrectly interpreted as a request for a document with ID stats, leading to an error.
    *   **Debug checklist:** Move the  definition to be *before* the  definition in .
    *   **Why to solve this issue and what will be achieved with this?** This is a simple logic bug that breaks the stats endpoint. Fixing it will restore the intended functionality.
    *   **Should Test frontend/backend/both after fix:** Backend
    *   **Is recurring issue?** N

**Known issue recurrence from previous fork**
N/A.

**Code Architecture**
LinkingContext

**Key Technical Concepts**
- **Frontend:** React Native, Expo (SDK 54), Expo Router, TypeScript
- **Backend:** Python, FastAPI, Pydantic, 
- **Database:** MongoDB
- **AI/ML:** OpenAI Vision API () for OCR.
- **3rd Party Services:** Resend (email),  &  (PDF/Image processing).

**key DB schema**
- ****: 
- ****: 

**changes in tech stack**
- **Backend:** Added  dependency for server-side PDF generation.

**All files of reference**
- **/app/frontend/app/(tabs)/vault.tsx**: Main file for document management, needs urgent refactoring.
- **/app/frontend/app/(tabs)/profile.tsx**: The user profile view.
- **/app/frontend/app/profile-edit.tsx**: The user profile edit screen to be implemented.
- **/app/frontend/app/_layout.tsx**: Root layout file, central to the  bug.
- **/app/backend/routes/documents.py**: Contains the backend logic for documents and the API route order bug.
- **/app/backend/routes/user_routes.py**: Contains the backend logic for user profiles.

**Areas that need refactoring**:
- **/app/frontend/app/(tabs)/vault.tsx**: **[CRITICAL]** This file is now over 1700 lines. To fix a build error, the agent merged all OCR-related UI logic (upload, verification, inline-editing) directly into this file instead of using separate components as planned. This must be undone. The original import error needs to be properly debugged, and the logic must be extracted into smaller components (, , etc.) to restore maintainability.

**key api endpoints**
- : Handles OCR processing for uploaded files.
- : Full CRUD for documents stored in MongoDB.
- : Generates a PDF export of documents.
- : Manages user profile data.

**Critical Info for New Agent**
- **Fix the  bug first.** This is the highest priority (P0). The app is not stable enough for further development or testing until this recurring crash is permanently resolved.
- **Refactor .** After the  bug is fixed, the next priority should be to break down the monolithic  file into the smaller, manageable components that were originally planned. Do not add more features to it in its current state.
- **Fix the backend route order.** The  endpoint is broken due to incorrect ordering in . This is a quick fix that should be addressed.

**documents and test reports created in this job**
-  (Continuously updated)
-  (Successful test of the initial OCR feature)

**Last 10 User Messages and any pending HUMAN messages**
1.  **User Request:** Store the image... Filter by period and/or all documents. (Task for filtering is pending).
2.  **User Request:** Once Ive configured my profile, Id like the profile tab to show Romain, my ranking number... and when I click to update my profile I can only modify my ranking, my email address, my desired fiscal residence. (This is the current  task).
3.  **User Request:** integrate apple wheel picker. (Partially done in onboarding, pending for document editing).
4.  **User Confirmation:** 1 2 3 (Confirmed priorities from a list).
5.  **User Confirmation:** inline editing. (Task completed).
6.  **User Confirmation:** Continue next actions. (Gave go-ahead after OCR was done).
7.  **User Confirmation:** P0 et p1. (Confirmed priorities for backend/frontend work).

**Project Health Check:**
- **Broken:** The frontend is unstable due to the critical, recurring  navigation error.
- **Mocked:** None. The application is now fully data-driven from the MongoDB backend.

**3rd Party Integrations**
- **OpenAI GPT-4o**: Uses a User-provided API Key for OCR.
- **Resend**: Email API, requires User API Key.
- **MongoDB**: NoSQL Database.
- **reportlab**: New Python library for PDF generation.

**Testing status**
- **Testing agent used after significant changes:** YES. It successfully validated the OCR system in .
- **Troubleshoot agent used after agent stuck in loop:** YES. It was used to diagnose the  issue and correctly identified a missing , though this did not ultimately solve the root problem.
- **Test files created:** []
- **Known regressions:** The entire frontend navigation system is prone to crashing.

**Credentials to test flow:**
- **Admin Dashboard:**
    - **Email:** 
    - **Password:** 
- **OpenAI Key:** Available in .

**What agent forgot to execute**
- The agent did not fix the backend API route order for .
- The agent abandoned the plan to use separate components for the OCR UI and instead created a monolithic  file as a workaround for a build error, which is a major source of technical debt.
- The agent created a new date picker component () but never integrated it into the document editing modal in .</analysis>
