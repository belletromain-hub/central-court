{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":89,"index":89}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"expo-web-browser","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":90},"end":{"line":2,"column":47,"index":137}}],"key":"qFWzf28Sq0474idIhFBHQFboHaY=","exportNames":["*"],"imports":1}},{"name":"expo-linking","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":138},"end":{"line":3,"column":40,"index":178}}],"key":"UOn5wJuCXvTT9EneNUmI6H0GQgM=","exportNames":["*"],"imports":1}},{"name":"expo-secure-store","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":179},"end":{"line":4,"column":49,"index":228}}],"key":"BU2XtfznZ4PiVldqd/oueHCCaLo=","exportNames":["*"],"imports":1}},{"name":"react-native-web/dist/exports/Platform","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dV3bI3NOD8bfMzaIniMaFGy/nn8=","exportNames":["*"],"imports":1}},{"name":"expo-constants","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":270},"end":{"line":6,"column":39,"index":309}}],"key":"pPv5KzfRT0rL6NCr7G9k0o4d1W8=","exportNames":["*"],"imports":1}},{"name":"react/jsx-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"3suYSPX9nHbHZ1xNTsKXtKj0atE=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function(g,r,i,a,m,_e,_d){\"use strict\";function e(e){if(e&&e.__esModule)return e;var t={};return e&&Object.keys(e).forEach(function(o){var n=Object.getOwnPropertyDescriptor(e,o);Object.defineProperty(t,o,n.get?n:{enumerable:!0,get:function(){return e[o]}})}),t.default=e,t}Object.defineProperty(_e,'__esModule',{value:!0}),Object.defineProperty(_e,\"AuthProvider\",{enumerable:!0,get:function(){return y}}),Object.defineProperty(_e,\"useAuth\",{enumerable:!0,get:function(){return _}});var t=r(_d[0]);e(r(_d[1])),e(r(_d[2])),e(r(_d[3]));r(_d[4]);var o,n=r(_d[5]),s=(o=n)&&o.__esModule?o:{default:o},c=r(_d[6]);const u=(0,t.createContext)(void 0),l=s.default.expoConfig?.extra?.EXPO_PUBLIC_BACKEND_URL||process.env.EXPO_PUBLIC_BACKEND_URL||'',h=async()=>localStorage.getItem('session_token'),d=async e=>{localStorage.setItem('session_token',e)},f=async()=>{localStorage.removeItem('session_token')},w=e=>{try{const t=e.match(/[#&]session_id=([^&]+)/);if(t)return t[1];const o=e.match(/[?&]session_id=([^&#]+)/);return o?o[1]:null}catch{return null}},y=({children:e})=>{const[o,n]=(0,t.useState)(null),[s,y]=(0,t.useState)(!0),[_,p]=(0,t.useState)(null);(0,t.useEffect)(()=>{v();{window.location.hash;const e=w(window.location.href);e&&(P(e),window.history.replaceState({},document.title,window.location.pathname))}},[]);const v=async()=>{try{const e=await h();if(!e)return void y(!1);const t=await fetch(`${l}/api/auth/me`,{headers:{Authorization:`Bearer ${e}`}});if(t.ok){const e=await t.json();n(e)}else await f()}catch(e){console.error('Session check error:',e),await f()}finally{y(!1)}},P=async(e,t)=>{y(!0);try{let o=`${l}/api/auth/exchange-session`,s={session_id:e};t&&(o=`${l}/api/auth/register-with-invitation`,s={session_id:e,invitation_code:t});const c=await fetch(o,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(s)});if(!c.ok){const e=await c.json();throw console.error('Session exchange error:',e),new Error(e.detail||'Authentication failed')}{const e=await c.json();await d(e.session_token),n(e.user),p(null)}}catch(e){throw console.error('Session exchange error:',e),e}finally{y(!1)}},S=async()=>{y(!0);try{const e=window.location.origin+'/',t=`https://auth.emergentagent.com/?redirect=${encodeURIComponent(e)}`;window.location.href=t}catch(e){console.error('Login error:',e),y(!1)}};return(0,c.jsx)(u.Provider,{value:{user:o,isLoading:s,isAuthenticated:!!o,login:S,loginWithInvitation:async e=>{p(e),await S()},logout:async()=>{try{const e=await h();e&&await fetch(`${l}/api/auth/logout`,{method:'POST',headers:{Authorization:`Bearer ${e}`}})}catch(e){console.error('Logout error:',e)}finally{await f(),n(null)}},refreshUser:async()=>{await v()}},children:e})},_=()=>{const e=(0,t.useContext)(u);if(!e)throw new Error('useAuth must be used within AuthProvider');return e}});","lineCount":1,"map":[[1,327,74,0,"Object"],[1,334,74,0,"defineProperty"],[1,349,74,0,"_e"],[1,352,74,0],[1,368,74,0,"enumerable"],[1,380,74,0],[1,382,74,0,"get"],[1,386,74,0],[1,404,74,0,"AuthProvider"],[1,405,74,0],[1,409,237,0,"Object"],[1,416,237,0,"defineProperty"],[1,431,237,0,"_e"],[1,434,237,0],[1,445,237,0,"enumerable"],[1,457,237,0],[1,459,237,0,"get"],[1,463,237,0],[1,481,237,0,"useAuth"],[1,482,237,0],[1,486,1,0],[1,490,1,0,"_react"],[1,492,1,0,"r"],[1,494,1,0,"_d"],[1,497,1,0],[1,501,2,0,"_interopNamespace"],[1,503,2,0,"r"],[1,505,2,0,"_d"],[1,508,2,0],[1,513,3,0,"_interopNamespace"],[1,515,3,0,"r"],[1,517,3,0,"_d"],[1,520,3,0],[1,525,4,0,"_interopNamespace"],[1,527,4,0,"r"],[1,529,4,0,"_d"],[1,532,4,0],[1,537,4,49,"r"],[1,539,4,49,"_d"],[1,542,4,49],[1,546,6,0],[1,550],[1,552,6,0,"_expoConstants"],[1,554,6,0,"r"],[1,556,6,0,"_d"],[1,559,6,0],[1,563,6,0,"Constants"],[1,566],[1,568,6,0,"_expoConstants"],[1,572],[1,599,6,39,"_reactJsxRuntime"],[1,601,6,39,"r"],[1,603,6,39,"_d"],[1,606,6,39],[1,610,27,0],[1,616,27,6,"AuthContext"],[1,619,27,20],[1,621,27,20,"createContext"],[1,623,27,33,"createContext"],[1,643,27,63,"undefined"],[1,646,29,6,"API_URL"],[1,648,29,16,"Constants"],[1,650,29,25,"default"],[1,658,29,26,"expoConfig"],[1,670,29,38,"extra"],[1,677,29,45,"EXPO_PUBLIC_BACKEND_URL"],[1,702,30,16,"process"],[1,710,30,24,"env"],[1,714,30,28,"EXPO_PUBLIC_BACKEND_URL"],[1,739,31,16],[1,742,34,6,"getSessionToken"],[1,744,34,24,"async"],[1,753,36,11,"localStorage"],[1,766,36,24,"getItem"],[1,774,36,32],[1,791,41,6,"setSessionToken"],[1,793,41,24,"async"],[1,803,43,4,"localStorage"],[1,816,43,17,"setItem"],[1,824,43,25],[1,840,43,42,"token"],[1,844,49,6,"removeSessionToken"],[1,846,49,27,"async"],[1,856,51,4,"localStorage"],[1,869,51,17,"removeItem"],[1,880,51,28],[1,898,58,6,"parseSessionIdFromUrl"],[1,900,58,31,"url"],[1,904,59,2],[1,908,61,4],[1,914,61,10,"hashMatch"],[1,916,61,22,"url"],[1,918,61,26,"match"],[1,924,61,32],[1,950,62,4],[1,953,62,8,"hashMatch"],[1,955,62,19],[1,962,62,26,"hashMatch"],[1,964,62,36],[1,967,65,4],[1,973,65,10,"queryMatch"],[1,975,65,23,"url"],[1,977,65,27,"match"],[1,983,65,33],[1,1010,66,4],[1,1017,66,8,"queryMatch"],[1,1019,66,27,"queryMatch"],[1,1021,66,38],[1,1024,68,11],[1,1028,69,2],[1,1029,69,4],[1,1035,70,4],[1,1042,70,11],[1,1046,71,2],[1,1049,74,13,"AuthProvider"],[1,1051,74,63,"AuthProvider"],[1,1053,74,66,"children"],[1,1068,75,2],[1,1074,75,9,"user"],[1,1076,75,15,"setUser"],[1,1080,75,26],[1,1082,75,26,"useState"],[1,1084,75,34,"useState"],[1,1094,75,48],[1,1101,76,9,"isLoading"],[1,1103,76,20,"setIsLoading"],[1,1107,76,36],[1,1109,76,36,"useState"],[1,1111,76,44,"useState"],[1,1122,76,45],[1,1126,77,9,"pendingInvitation"],[1,1128,77,28,"setPendingInvitation"],[1,1132,77,52],[1,1134,77,52,"useState"],[1,1136,77,60,"useState"],[1,1146,77,76],[1,1153,80,2],[1,1155,80,2,"useEffect"],[1,1157,80,11,"useEffect"],[1,1168,80,12],[1,1173,81,4,"checkExistingSession"],[1,1177,84,31],[1,1178,85,19,"window"],[1,1185,85,26,"location"],[1,1194,85,35,"hash"],[1,1199,85,6],[1,1205,86,12,"sessionId"],[1,1207,86,24,"parseSessionIdFromUrl"],[1,1209,86,46,"window"],[1,1216,86,53,"location"],[1,1225,86,62,"href"],[1,1231,87,10,"sessionId"],[1,1235,88,8,"handleSessionExchange"],[1,1237,88,30,"sessionId"],[1,1240,90,8,"window"],[1,1247,90,15,"history"],[1,1255,90,23,"replaceState"],[1,1268,90,36],[1,1269,90,37],[1,1271,90,40,"document"],[1,1280,90,49,"title"],[1,1286,90,56,"window"],[1,1293,90,63,"location"],[1,1302,90,72,"pathname"],[1,1312,92,4],[1,1315,93,5],[1,1319,95,2],[1,1325,95,8,"checkExistingSession"],[1,1327,95,31,"async"],[1,1337,96,4],[1,1341,97,6],[1,1347,97,12,"token"],[1,1355,97,26,"getSessionToken"],[1,1359,98,6],[1,1363,98,11,"token"],[1,1365,100,8],[1,1377,99,8,"setIsLoading"],[1,1380,99,21],[1,1383,103,6],[1,1389,103,12,"response"],[1,1397,103,29,"fetch"],[1,1403,103,35],[1,1406,103,38,"API_URL"],[1,1422,103,61],[1,1423,104,8,"headers"],[1,1431,104,17],[1,1432,105,10,"Authorization"],[1,1446,105,27],[1,1456,105,37,"token"],[1,1463,109,6],[1,1466,109,10,"response"],[1,1468,109,19,"ok"],[1,1471,109,23],[1,1472,110,8],[1,1478,110,14,"userData"],[1,1486,110,31,"response"],[1,1488,110,40,"json"],[1,1495,111,8,"setUser"],[1,1497,111,16,"userData"],[1,1499,112,6],[1,1511,113,14,"removeSessionToken"],[1,1514,115,4],[1,1515,115,6],[1,1521,115,13,"error"],[1,1524,116,6,"console"],[1,1532,116,14,"error"],[1,1538,116,20],[1,1561,116,44,"error"],[1,1570,117,12,"removeSessionToken"],[1,1573,118,4],[1,1574,118,5],[1,1582,119,6,"setIsLoading"],[1,1585,119,19],[1,1587,120,4],[1,1590,123,8,"handleSessionExchange"],[1,1592,123,32,"async"],[1,1598,123,39,"sessionId"],[1,1600,123,58,"invitationCode"],[1,1605,124,4,"setIsLoading"],[1,1608,124,17],[1,1611,125,4],[1,1615,126,6],[1,1619,126,10,"endpoint"],[1,1621,126,21],[1,1624,126,24,"API_URL"],[1,1654,127,10,"body"],[1,1656,127,22],[1,1657,127,24,"session_id"],[1,1668,127,36,"sessionId"],[1,1671,129,10,"invitationCode"],[1,1675,130,8,"endpoint"],[1,1677,130,19],[1,1680,130,22,"API_URL"],[1,1718,131,8,"body"],[1,1720,131,15],[1,1721,131,17,"session_id"],[1,1732,131,29,"sessionId"],[1,1734,131,40,"invitation_code"],[1,1750,131,57,"invitationCode"],[1,1754,134,6],[1,1760,134,12,"response"],[1,1768,134,29,"fetch"],[1,1774,134,35,"endpoint"],[1,1776,134,45],[1,1777,135,8,"method"],[1,1784,135,16],[1,1791,136,8,"headers"],[1,1799,136,17],[1,1800,136,19],[1,1815,136,35],[1,1835,137,8,"body"],[1,1840,137,14,"JSON"],[1,1845,137,19,"stringify"],[1,1855,137,29,"body"],[1,1860,140,6],[1,1864,140,10,"response"],[1,1866,140,19,"ok"],[1,1869,145,13],[1,1870,146,8],[1,1876,146,14,"error"],[1,1884,146,28,"response"],[1,1886,146,37,"json"],[1,1893,148,8],[1,1899,147,8,"console"],[1,1907,147,16,"error"],[1,1913,147,22],[1,1939,147,49,"error"],[1,1942,148,14],[1,1946,148,18,"Error"],[1,1952,148,24,"error"],[1,1954,148,30,"detail"],[1,1962,148,40],[1,1986,149,6],[1,1987,140,23],[1,1988,141,8],[1,1994,141,14,"data"],[1,2002,141,27,"response"],[1,2004,141,36,"json"],[1,2017,142,14,"setSessionToken"],[1,2019,142,30,"data"],[1,2021,142,35,"session_token"],[1,2036,143,8,"setUser"],[1,2038,143,16,"data"],[1,2040,143,21,"user"],[1,2046,144,8,"setPendingInvitation"],[1,2048,144,29],[1,2053,145,6],[1,2054,150,4],[1,2055,150,6],[1,2061,150,13,"error"],[1,2064,152,6],[1,2070,151,6,"console"],[1,2078,151,14,"error"],[1,2084,151,20],[1,2110,151,47,"error"],[1,2113,152,12,"error"],[1,2114,153,4],[1,2115,153,5],[1,2123,154,6,"setIsLoading"],[1,2126,154,19],[1,2128,155,4],[1,2131,158,8,"login"],[1,2133,158,16,"async"],[1,2143,159,4,"setIsLoading"],[1,2146,159,17],[1,2149,160,4],[1,2153,162,6],[1,2159,162,12,"redirectUrl"],[1,2161,163,10,"window"],[1,2168,163,17,"location"],[1,2177,163,26,"origin"],[1,2184,163,35],[1,2188,166,12,"authUrl"],[1,2190,166,22],[1,2234,166,66,"encodeURIComponent"],[1,2253,166,85,"redirectUrl"],[1,2258,170,8,"window"],[1,2265,170,15,"location"],[1,2274,170,24,"href"],[1,2279,170,31,"authUrl"],[1,2280,186,4],[1,2281,186,6],[1,2287,186,13,"error"],[1,2290,187,6,"console"],[1,2298,187,14,"error"],[1,2304,187,20],[1,2319,187,36,"error"],[1,2322,188,6,"setIsLoading"],[1,2325,188,19],[1,2327,189,4],[1,2330,220,2],[1,2337,221,4],[1,2339,221,4,"_reactJsxRuntime"],[1,2341,221,4,"jsx"],[1,2346,221,5,"AuthContext"],[1,2348,221,17,"Provider"],[1,2357,221,25],[1,2358,222,6,"value"],[1,2364,222,13],[1,2365,223,8,"user"],[1,2372,224,8,"isLoading"],[1,2384,225,8,"isAuthenticated"],[1,2402,225,27,"user"],[1,2404,226,8,"login"],[1,2412,227,8,"loginWithInvitation"],[1,2432,192,30,"async"],[1,2442,193,4,"setPendingInvitation"],[1,2444,193,25,"invitationCode"],[1,2453,194,10,"login"],[1,2458,228,8,"logout"],[1,2465,197,17,"async"],[1,2475,198,4],[1,2479,199,6],[1,2485,199,12,"token"],[1,2493,199,26,"getSessionToken"],[1,2497,200,10,"token"],[1,2506,201,14,"fetch"],[1,2512,201,20],[1,2515,201,23,"API_URL"],[1,2535,201,50],[1,2536,202,10,"method"],[1,2543,202,18],[1,2550,203,10,"headers"],[1,2558,203,19],[1,2559,204,12,"Authorization"],[1,2573,204,29],[1,2583,204,39,"token"],[1,2589,208,4],[1,2590,208,6],[1,2596,208,13,"error"],[1,2599,209,6,"console"],[1,2607,209,14,"error"],[1,2613,209,20],[1,2629,209,37,"error"],[1,2631,210,4],[1,2632,210,5],[1,2646,211,12,"removeSessionToken"],[1,2650,212,6,"setUser"],[1,2652,212,14],[1,2657,213,4],[1,2660,229,8,"refreshUser"],[1,2672,216,22,"async"],[1,2688,217,10,"checkExistingSession"],[1,2694,230,8,"children"],[1,2703,232,7,"children"],[1,2708,237,13,"useAuth"],[1,2710,237,23,"useAuth"],[1,2715,238,2],[1,2721,238,8,"context"],[1,2724,238,18],[1,2726,238,18,"useContext"],[1,2728,238,28,"useContext"],[1,2740,238,29,"AuthContext"],[1,2743,239,2],[1,2747,239,7,"context"],[1,2749,240,4],[1,2755,240,10],[1,2759,240,14,"Error"],[1,2765,240,20],[1,2809,242,2],[1,2816,242,9,"context"],[1,2818,243,2],[1,2821]],"functionMap":{"names":["<global>","getSessionToken","setSessionToken","removeSessionToken","parseSessionIdFromUrl","AuthProvider","useEffect$argument_0","checkExistingSession","handleSessionExchange","login","loginWithInvitation","logout","refreshUser","useAuth"],"mappings":"AAA;wBCiC;CDK;wBEE;CFM;2BGE;CHM;8BIG;CJc;+DKE;YCM;GDa;+BEE;GF0B;gCGE;GHiC;gBIE;GJgC;8BKE;GLG;iBME;GNiB;sBOE;GPE;CLiB;uBaE;CbM"},"hasCjsExports":false},"type":"js/module"}]}